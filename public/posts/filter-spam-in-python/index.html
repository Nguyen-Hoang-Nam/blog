<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="icon" href="/images/logo.ico" />
    <link rel="apple-touch-icon" href="/images/logo.ico" />

    
    <meta property="og:type" content="website" />

    
    <meta name="twitter:card" content="summary_large_image" key="twcard" />
     
    <meta
        name="twitter:site"
        content="@nguyenh79185323"
        key="twhandle"
    />
     
    <title>DevOT blog | Cùng nhau chặn Spam bằng Python nào</title>

    
    <meta name="keywords" content="Spam,Python,ML,NLP," />
    

    <meta property="og:url" content="https://devot.netlify.app/posts/filter-spam-in-python/" />
    <meta
        property="og:title"
        content="Cùng nhau chặn Spam bằng Python nào &middot; DevOT blog"
    />

    <meta name="description" content="Trong bài viết nhỏ này, mình sẽ hướng dẫn cách để tạo ra một hệ thống chống Spam nho nhỏ. Mình thấy bài viết cũng rất phù hợp với các bạn muốn tìm hiểu về xử lý ngôn ngữ tự nhiên (NLP)." />
    
    <meta name="og:description" content="Trong bài viết nhỏ này, mình sẽ hướng dẫn cách để tạo ra một hệ thống chống Spam nho nhỏ. Mình thấy bài viết cũng rất phù hợp với các bạn muốn tìm hiểu về xử lý ngôn ngữ tự nhiên (NLP)." />
     
    <meta
        property="og:image"
        content="https://devot.netlify.app/posts/filter-spam-in-python/cover.webp"
        key="ogimage"
    />
    

    <link rel="canonical" href="https://devot.netlify.app/posts/filter-spam-in-python/" />
    

    <meta name="theme-color" content="#f2f2f2" />

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-48E9108RES"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-48E9108RES', { 'anonymize_ip': false });
}
</script>


    <link rel="stylesheet" type="text/css" href="/css/index.css" />
    <link
        rel="stylesheet"
        type="text/css"
        href="/css/syntax-light.css"
        id="chroma-theme"
    />

    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Lora&display=swap"
        rel="stylesheet"
    />
</head>
<body class="flex flex-column" id="body"><div class="header">
        

    <img
        data-src="cover.webp"
        id="header-img"
        class="lozad header-img"
        data-alt="Profile"
    />
</div>


<p
    class="text-align-center font-serif font-normal secondary-color header-credit"
>
    Photo by
    <a href="https://unsplash.com/@jamesrkern?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">James Kern</a>
    on <a href="https://unsplash.com/s/photos/spam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>
</p>


<div class="flex main">
    <div class="flex position-relative main-container"><div
    class="flex flex-column align-item-center font-sans-serif font-normal sidebar"
>
    <div class="sticky-table">
        <div class="position-relative sidebar-avatar">
            <img
                src="/images/avatar.webp"
                class="sidebar-avatar-img"
                alt="Avatar"
                width="200"
                height="200"
            />

            <div id="mode"></div>
        </div>

        <div class="text-align-center font-bold sidebar-title">
            <a href="/">DevOT blog</a>
            <a class="sidebar-rss" href="/feed.xml" aria-label="">
                <img
                    id="rss"
                    class=""
                    src="/images/rss-light.png"
                    alt="RSS"
                    width="16"
                    height="16"
                />
            </a>
             
        </div>

        <div
            class="text-align-center font-sans-serif font-normal primary-color sidebar-language"
        >
            
            <p>vn</p>
            /
            <a href="/en/posts/filter-spam-in-python/">en</a>
            
        </div>

        <div class="flex align-item-center sidebar-social">
            <a
                class="primary-color resp-sharing-button__link"
                href="https://github.com/Nguyen-Hoang-Nam"
                target="_blank"
                rel="noopener"
                aria-label="Github profile"
            >
                <img
                    id="github-icon-1"
                    class="social-icon"
                    src="/images/GitHub-Mark-32px.png"
                    alt="Github"
                    width="20"
                    height="20"
                />
            </a>

            <a
                class="primary-color resp-sharing-button__link"
                href="https://www.linkedin.com/in/nam-nguy%E1%BB%85n-5b05711bb/"
                target="_blank"
                rel="noopener"
                aria-label="Linkedin profile"
            >
                <div
                    class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"
                >
                    <div
                        aria-hidden="true"
                        class="resp-sharing-button__icon resp-sharing-button__icon--solid"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"
                            />
                        </svg>
                    </div>
                </div>
            </a>

            <a
                class="primary-color resp-sharing-button__link"
                href="https://www.facebook.com/profile.php?id=100064522001764"
                target="_blank"
                rel="noopener"
                aria-label="Facebook profile"
            >
                <div
                    class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"
                >
                    <div
                        aria-hidden="true"
                        class="resp-sharing-button__icon resp-sharing-button__icon--solid"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"
                            />
                        </svg>
                    </div>
                </div>
            </a>

            <a
                class="primary-color resp-sharing-button__link"
                href="https://twitter.com/nguyenh79185323"
                target="_blank"
                rel="noopener"
                aria-label="Twitter profile"
            >
                <div
                    class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"
                >
                    <div
                        aria-hidden="true"
                        class="resp-sharing-button__icon resp-sharing-button__icon--solid"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"
                            />
                        </svg>
                    </div>
                </div>
            </a>
        </div>

        <div class="sponsor">
            <p class="text-align-center">Buy me a coffee</p>
            <div class="flex sponsor-container">
                <button
                    class="font-sans-serif font-bold text-align-center sponsor-button"
                    id="connect-metamask"
                >
                    ETH
                </button>
                <button
                    class="font-sans-serif font-bold text-align-center sponsor-button"
                    id="connect-phantom"
                >
                    SOL
                </button>
            </div>
        </div>
    </div>
</div>
<div class="font-serif content">
            <div class="position-relative content-container">
                <h1>Cùng nhau chặn Spam bằng Python nào</h1>
                 
<time datetime="2022-03-10">Mar 10, 2022</time>


                <br /><br />

                <p>&ldquo;Bạn vừa trúng một chiếc IPhone&rdquo;, &ldquo;Ban là người may mắn thứ 101&rdquo; những câu nói này nghe quen với bạn chứ. Trong bài viết
nhỏ này, mình sẽ hướng dẫn cách để tạo ra một hệ thống chống Spam nho nhỏ. Mình thấy bài viết cũng rất phù hợp với các
bạn muốn tìm hiểu về xử lý ngôn ngữ tự nhiên (NLP).</p>
<p>Để bạn có thể đọc bài viết một cách hiệu quả nhất việc biết 1 chút Python cũng như Google Colab chắc chắn là một lợi thế.
Nếu không thì các bạn cũng yên tâm, mình sẽ giải thích kĩ từng phần.</p>
<h2 id="một-chút-chuẩn-bị">
    
        <a href="#m%e1%bb%99t-ch%c3%bat-chu%e1%ba%a9n-b%e1%bb%8b">#</a>
        Một chút chuẩn bị
    
</h2>
<p>Đối với các bạn nào chưa từng thử xử lý ngôn ngữ tự nhiên, thì mình nghĩ phần này có thể cho bạn một vài cái nhìn tổng
quát về những thứ mình chuẩn bị làm. Với các bạn đã nắm sơ ý tưởng, ta có thể xem từ chương kế tiếp.</p>
<p>Trước hết cùng mình phân tích đề tài này nha. Việc chặn Spam thực chất quy về việc xác định một đoạn Text là Spam. Oki,
có vẻ hợp lý nhưng làm sao để xác định đây là Spam nhỉ? Thì xác định Spam có thể hiểu là phần dữ liệu thành những tin
nhắn Spam và không Spam (mà mình tạm gọi là Ham).</p>
<p>Oki vậy chắc bạn sẽ thắc mắc thế nào là Spam, nào là Ham. Thú thật mình cũng không có câu trả lời đâu 😅, mà thực ra
việc hệ thống bạn xác định đó Spam hay không phụ thuộc vào việc đánh nhãn mà mình sẽ nói ở dưới, nên nếu bạn cần tìm
tiêu chí để xác định Spam hay Ham thì bạn có thể hỏi người đánh nhãn nha 😅. Vì vậy có cơ hội bạn nên trưc tiếp thu
nhập dữ liệu và đánh nhãn nha.</p>
<p>Để thực hiện việc phân loại dữ liệu dạng Text thì xử lý ngôn ngữ tự nhiên thường theo một quy trình như sau:</p>
<p>  
<figure>
    <figure>
        <img
            class="lozad"
            data-src="diagram1.png"
            alt="Diagram 1"
            width="761"
            height="121"
        />
        <figcaption>Quy trình xử lý ngôn ngữ tự nhiên đơn giản</figcaption>
    </figure>
    
</figure>
</p>
<p>Cùng mình đi qua cái quy trình này xíu nha. Thu thập dữ liệu, đây là bước tiên quyết mà bạn cần phải làm, lý do là vì
dữ liệu là đầu vào của việc huấn luyện. Đánh nhãn, đây cũng là một bước cực kì quan trọng, do dữ liệu bạn thu nhập
được ở bước 1 không đủ thông tin để có thể Training được, nó cũng giống như bạn in sách giáo khoa và bỏ hết đề mục
vậy.</p>
<p>Tin mình đi, nếu bạn làm được 2 bước này là bạn đã làm hết những việc nặng rồi đó do nó thường tốn rất nhiều thời gian.
Vì lý do này những trang Web lưu dữ liệu được đánh nhãn sản ra đời như <a href="https://www.kaggle.com/">Kaggle</a>, nhờ đó giảm
bớt thời gian khi bạn cần thực hiện những Task đơn giản.</p>
<p>Ta tiếp tục với việc tiền xử lý, dù dữ liệu đã được đánh nhãn, thông tin trong dữ liệu đó vấn chứa những thông tin nhiễu
cũng như đôi khi dữ liệu quá lớn cũng làm chậm quá trình huấn luyện. Tiền xử lý giúp ta loại bớt thông tin không cần thiết
từ đó đạt được dữ liệu tốt hơn cũng như nhẹ hơn.</p>
<p>Từ nãy tới giờ, chúng ta vẫn chưa hề liên kết các thông tin lại với nhau, các đoạn Text đối với máy tính đều rời rạc
nhau. Để giải quyết vấn đề này ta cần làm bước trích xuất dữ liệu mà thực chất là liên kết các từ cũng như các đoạn
Text với nhau để tìm ra đặc trưng. Ngoài việc tìm đặc trưng thì ta cũng cần cái đầu ra là những Vector để có thể tiếp
tục bước kế tiếp.</p>
<p>Bước cuối cùng có vẻ khó nhất nhưng thực ra ta thường thực hiện rất nhanh đó là việc phân loại dựa vào đặc trưng mà ta
tìm được ở bước trên.</p>
<h2 id="bắt-đầu-thôi">
    
        <a href="#b%e1%ba%aft-%c4%91%e1%ba%a7u-th%c3%b4i">#</a>
        Bắt đầu thôi
    
</h2>
<h3 id="chuẩn-bị-dữ-liệu-có-nhãn">
    
        <a href="#chu%e1%ba%a9n-b%e1%bb%8b-d%e1%bb%af-li%e1%bb%87u-c%c3%b3-nh%c3%a3n">#</a>
        Chuẩn bị dữ liệu có nhãn
    
</h3>
<p>Như mình có đề cập ở trên bước này sẽ tốn tương đối nhiều thời gian, nên mình sẽ dùng một bộ dữ liệu có sẵn nha, nhưng
mình chưa tìm thấy bộ dữ liệu có sẵn Tiếng Việt nên ta dùng bộ dữ liệu Tiếng Anh nha. Bạn truy cập vào link sau <a href="https://www.kaggle.com/uciml/sms-spam-collection-dataset">Kaggle</a>, tải về rồi upload lại lên Drive của bạn nha. Xong bước trên thì cùng mình tới phần code nào.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</code></pre></div><p>Dòng Code này sẽ giúp bạn liên kết Colab và Drive của bạn vì bạn đang lưu bộ dữ liệu trên Drive. Sau đó cùng mình xem
qua một vài dòng trong dự liệu nha.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">sms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Dev/Spam/spam.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">sms</span> <span class="o">=</span> <span class="n">sms</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 2&#39;</span><span class="p">,</span><span class="s1">&#39;Unnamed: 3&#39;</span><span class="p">,</span><span class="s1">&#39;Unnamed: 4&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sms</span> <span class="o">=</span> <span class="n">sms</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;v1&#39;</span><span class="p">:</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="s1">&#39;v2&#39;</span><span class="p">:</span><span class="s1">&#39;message&#39;</span><span class="p">})</span>
<span class="n">sms</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><p>  
<figure>
    <figure>
        <img
            class="lozad"
            data-src="table1.png"
            alt="Table 1"
            width="445"
            height="354"
        />
        <figcaption>10 dòng đầu tiên của bộ dữ liệu</figcaption>
    </figure>
    
</figure>
</p>
<h3 id="tiền-xử-lý">
    
        <a href="#ti%e1%bb%81n-x%e1%bb%ad-l%c3%bd">#</a>
        Tiền xử lý
    
</h3>
<h4 id="bỏ-đấu-câu-nha">
    
        Bỏ đấu câu nha
    
</h4>
<p>Bước đầu tiên trong quá trình, mình nghĩ chúng ta nên bỏ đấu câu do nội dung tin nhắn Spam thường vẫn được giữ nguyên
khi bỏ dấu câu đi. Ảnh hưởng lớn nhất của quyết định này là thay đổi ngữ pháp của câu điều mà điều mà ta không xét
tới trong bài toán này.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">string</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
</code></pre></div><p>Mình giải thích xíu nha, hàm <code>maketrans</code> thường đi chung với hàm <code>translate</code> để thay thế các kí tự với tham số
đầu tiên là kí tự cần đổi, tham số kế là kí tự được đổi thành và tham số cuối là kí tự cần loại bỏ. Còn <code>string.punctuation</code>
sẽ cho ta một chuỗi các đấu câu như sau <code>!&quot;#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~</code></p>
<h4 id="bỏ-stop-words">
    
        Bỏ Stop Words
    
</h4>
<p>Bước thứ 2 thì không hiển nhiên lắm, Stop Words là các từ ít hỗ trợ nghĩa trong câu, chúng đôi khi đóng góp vào ngữ
pháp cho câu, đôi khi dùng để mang sắc thái biểu cảm. Nhưng chủ yếu là chúng không làm thay đổi quá nhiều nội dung
của câu khi có hoặc không có chúng, điều đó giúp ta có thể làm tập dữ liệu gọn hơn, Training nhanh hơn nhưng vẫn
cho kết quả tốt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)]</span>
</code></pre></div><p>Trong đoạn code ở trên thì 2 dòng đầu có nhiệm vụ load danh sách Stop Words cho bạn. Một lưu ý nhỏ cho bạn là
danh sách Stop Words thường không duy nhất, do đó nếu bạn tìm thấy một danh sách khác thì bạn cũng thử nha
biết đâu sẽ cho một kết quả tốt hơn.</p>
<h3 id="trích-xuất-đặc-trưng">
    
        <a href="#tr%c3%adch-xu%e1%ba%a5t-%c4%91%e1%ba%b7c-tr%c6%b0ng">#</a>
        Trích xuất đặc trưng
    
</h3>
<p>Khác với quá trình tiền xử lý, bước này thường ảnh hưởng rất lớn tới kết quả cũng như việc chọn thuật toán ở dưới
để phân loại. Do bài viết này mang tính giới thiệu thôi nên mình sẽ chọn phương pháp TF-IDF để rút trích đặc trưng.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf_features</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">text_feat</span><span class="p">)</span>

<span class="n">features_train</span><span class="p">,</span> <span class="n">features_test</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">tfidf_features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">111</span><span class="p">)</span>
</code></pre></div><p>Chi tiết phương pháp TF-IDF mình nghĩ xứng đáng có một bài viết riêng nền mình sẽ không trình bày ở đây. Trong đoạn
Code thì 2 dòng đầu sử dụng thư viện <code>sklearn</code> để lấy hàm <code>TfidfVectorizer</code> và một hàm khác làm nhiệm vụ
tách tập đặc trưng thành 2 để Train và Test. Tiếp theo đó t gọi hàm <code>TfidfVectorizer</code> và hàm <code>fit_transform</code>
để chuyển dữ liệu dạng những dòng chữ thành Vector. Cuối cùng ta phân các Vector đặc trưng này thành Train và Test.</p>
<h3 id="phân-loại">
    
        <a href="#ph%c3%a2n-lo%e1%ba%a1i">#</a>
        Phân loại
    
</h3>
<p>Oki bước cuối rồi nè, khác với những bước trên bước này có khá nhiều cách thực hiện chúng khác nhau chủ yếu ở thuật
toán được cài đặt. Thực tế cho thấy với các rút trích đặc trưng bằng TF-IDF thì thuật toán phân loại Naive Bayes cho
kết quả tốt nhất. Nên trong phần này mình sẽ sử dụng thuật toán này nha.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>

<span class="n">mnb</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">mnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">mnb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_test</span><span class="p">)</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">label_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)]</span>
</code></pre></div><p>Các bạn chắc cũng nắm được dòng đầu rồi ha, nó lấy cho ta hàm <code>MultinomiaNB</code> mà dễ hiểu là thuật toán Naive Bayes.
Ở phần kế ta khởi tạo thuật toán với tham số <code>alpha=0.2</code>, hàm <code>fit</code> giúp thuật toán sử dụng đặc trưng mà bạn
rút trích để Train thuật toán và hàm <code>predict</code> sẽ giúp bạn chạy thuật toán sau khi Train với dữ liệu Test. Đòng
cuối giúp mình tính kết quả của thuật toán dự đoán và kết quả đúng của dữ liệu Test từ đó ta có thể tiếp tục cải tiến.</p>
<h2 id="chốt-sổ-nào">
    
        <a href="#ch%e1%bb%91t-s%e1%bb%95-n%c3%a0o">#</a>
        Chốt sổ nào
    
</h2>
<p>Phù, cuối cùng cũng hết rồi các bạn à. Bài viết này mình đi sâu và mình nghĩ chắc chắn các bạn sẽ có rất nhiều câu
hỏi muốn được giải đáp, vì vậy hãy chờ đón những bài viết tiếp của mình về chủ đề này nha.</p>
            </div>

            <div class="flex content-footer">
                <div class="flex tags"><a href="https://devot.netlify.app/tags/spam/">#Spam</a>
    <a href="https://devot.netlify.app/tags/python/">#Python</a>
    <a href="https://devot.netlify.app/tags/ml/">#ML</a>
    <a href="https://devot.netlify.app/tags/nlp/">#NLP</a>
    </div>
 <div class="flex social">
      

    
    <a
        class="primary-color resp-sharing-button__link"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdevot.netlify.app%2fposts%2ffilter-spam-in-python%2f"
        target="_blank"
        rel="noopener"
        aria-label="Facebook share"
    >
        <div
            class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"
        >
            <div
                aria-hidden="true"
                class="resp-sharing-button__icon resp-sharing-button__icon--solid"
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"
                    />
                </svg>
            </div>
        </div>
    </a>

    
    <a
        class="primary-color resp-sharing-button__link"
        href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fdevot.netlify.app%2fposts%2ffilter-spam-in-python%2f&text=C%c3%b9ng%20nhau%20ch%e1%ba%b7n%20Spam%20b%e1%ba%b1ng%20Python%20n%c3%a0o&via="
        target="_blank"
        rel="noopener"
        aria-label="Twitter share"
    >
        <div
            class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"
        >
            <div
                aria-hidden="true"
                class="resp-sharing-button__icon resp-sharing-button__icon--solid"
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"
                    />
                </svg>
            </div>
        </div>
    </a>

    
    <a
        class="primary-color resp-sharing-button__link"
        href="mailto:?subject=Check%20out%20C%c3%b9ng%20nhau%20ch%e1%ba%b7n%20Spam%20b%e1%ba%b1ng%20Python%20n%c3%a0o.&body=C%c3%b9ng%20nhau%20ch%e1%ba%b7n%20Spam%20b%e1%ba%b1ng%20Python%20n%c3%a0o%2c%20by%20DevOT%20blog%0aTrong%20b%c3%a0i%20vi%e1%ba%bft%20nh%e1%bb%8f%20n%c3%a0y%2c%20m%c3%acnh%20s%e1%ba%bd%20h%c6%b0%e1%bb%9bng%20d%e1%ba%abn%20c%c3%a1ch%20%c4%91%e1%bb%83%20t%e1%ba%a1o%20ra%20m%e1%bb%99t%20h%e1%bb%87%20th%e1%bb%91ng%20ch%e1%bb%91ng%20Spam%20nho%20nh%e1%bb%8f.%20M%c3%acnh%20th%e1%ba%a5y%20b%c3%a0i%20vi%e1%ba%bft%20c%c5%a9ng%20r%e1%ba%a5t%20ph%c3%b9%20h%e1%bb%a3p%20v%e1%bb%9bi%20c%c3%a1c%20b%e1%ba%a1n%20mu%e1%bb%91n%20t%c3%acm%20hi%e1%bb%83u%20v%e1%bb%81%20x%e1%bb%ad%20l%c3%bd%20ng%c3%b4n%20ng%e1%bb%af%20t%e1%bb%b1%20nhi%c3%aan%20%28NLP%29.%0a%0ahttps%3a%2f%2fdevot.netlify.app%2fposts%2ffilter-spam-in-python%2f%0a"
        target="_self"
        rel="noopener"
        aria-label="Mail share"
    >
        <div
            class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"
        >
            <div
                aria-hidden="true"
                class="resp-sharing-button__icon resp-sharing-button__icon--solid"
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"
                    />
                </svg>
            </div>
        </div>
    </a>

    
    <a
        class="primary-color resp-sharing-button__link"
        href="https://reddit.com/submit/?url=https%3a%2f%2fdevot.netlify.app%2fposts%2ffilter-spam-in-python%2f;resubmit=true&amp;title=C%c3%b9ng%20nhau%20ch%e1%ba%b7n%20Spam%20b%e1%ba%b1ng%20Python%20n%c3%a0o"
        target="_blank"
        rel="noopener"
        aria-label="Reddit share"
    >
        <div
            class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"
        >
            <div
                aria-hidden="true"
                class="resp-sharing-button__icon resp-sharing-button__icon--solid"
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"
                    />
                </svg>
            </div>
        </div>
    </a>
</div>

            </div>

            <div class="comments-container">
                <script
    src="https://utteranc.es/client.js"
    repo="Nguyen-Hoang-Nam/blog"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    id="comment-script"
    async
></script>

            </div>
        </div>

        
<div class="font-sans-serif position-absolute table-of-content">
    <div class="sticky-table">
        <h3>Table of contents</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#một-chút-chuẩn-bị">Một chút chuẩn bị</a></li>
    <li><a href="#bắt-đầu-thôi">Bắt đầu thôi</a>
      <ul>
        <li><a href="#chuẩn-bị-dữ-liệu-có-nhãn">Chuẩn bị dữ liệu có nhãn</a></li>
        <li><a href="#tiền-xử-lý">Tiền xử lý</a></li>
        <li><a href="#trích-xuất-đặc-trưng">Trích xuất đặc trưng</a></li>
        <li><a href="#phân-loại">Phân loại</a></li>
      </ul>
    </li>
    <li><a href="#chốt-sổ-nào">Chốt sổ nào</a></li>
  </ul>
</nav>
    </div>
</div>


    </div>
</div>
<div
    class="flex align-item-center font-sans-serif font-normal secondary-color footer"
>
    <div>Copyright (c) 2022 Nguyen Hoang Nam</div>

    <div class="footer-icon">
        <a href="https://github.com/Nguyen-Hoang-Nam/blog">
            <img
                id="github-icon"
                src="/images/GitHub-Mark-32px.png"
                width="20"
                height="20"
                alt="Github"
            />
        </a>
    </div>
</div>
<script src="/js/lazyLoad.bundle.js"></script>
<script src="/js/index.bundle.js"></script>
<script src="/js/solana.bundle.js"></script>
<script src="/js/vendors.bundle.js"></script>
<script src="/js/runtime.bundle.js"></script>
<script>
    if ("serviceWorker" in navigator) {
        navigator.serviceWorker
            .register("service-worker.js", {
                scope: "/",
            })
            .then(function (registration) {
                console.log("Service Worker Registered");
            });

        navigator.serviceWorker.ready.then(function (registration) {
            console.log("Service Worker Ready");
        });
    }
</script>

</body>
</html>
